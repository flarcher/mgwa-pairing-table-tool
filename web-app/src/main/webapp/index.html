<html lang="fr">
  <head>
    <title>Table Pairing Tool</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="./style.css">
    <script src="./utils.js"></script>
    <script src="./status.js"></script>
    <script src="./matrix.js"></script>
    <script src="./tables.js"></script>
    <script src="./app.js"></script>
  </head>
  <body>
    <header>
      <span class="left badge hidden"><span>Step: </span><span id="steps"></span></span>
      <span class="title">Table Pairing Tool</span>
      <span class="right badge hidden"><span>Table: </span><span id="pairs"></span></span>
    </header>

    <nav class="hidden">
      <a data-target="init">New pairing</a>
      <a data-target="matrix">Score matrix</a>
      <!--a data-target="assign">Assignment</a>
      <a data-target="analysis">Analysis</a-->
      <a data-target="tables">Tables</a>
      <a data-target="export">Downloads</a>
    </nav>

    <section id="not_supported" class="error">Your browser is not supported</section>

    <section id="no_api" class="error">Error: the API can not be reached on port <span id="port"></span>: <span id="reason"></span></section>

    <section id="api_error" class="error">Error: the API returned an error <span id="status"></span>: <span id="message"></span></section>

    <section id="loading">
      <div class="loader"><span></span></div>
      <div>Loading...</div>
    </section>

    <section id="exited" class="error">The application was terminated</section>

    <section id="invalid">Invalid match setup: <span id="reason"></span></section>

    <section id="ready">

      <div id="init">
        <form>
          <fieldset>
            <legend>Team names</legend>
            <div>
              <label for="team_row_name">Rows</label>
              <input id="team_row_name" name="rows_team" type="text" minlength="1" maxlength="25" pattern="^[0-9a-zA-Z \\-_]+$" required/>
            </div>
            <div>
              <label for="team_col_name">Columns</label>
              <input id="team_col_name" name="cols_team" type="text" minlength="1" maxlength="25" pattern="^[0-9a-zA-Z \\-_]+$" required/>
            </div>
          </fieldset>
          <fieldset>
            <legend>Scores</legend>
            <div>
              <label for="team_size">Team size</label>
              <input id="team_size" name="size" type="number" step="1" min="3" max="10" value="8" />
            </div>
            <hr class="or">
            <div>
              <label for="matrix_file" class="file-label">Matrix file</label>
              <input type="file" id="matrix_file" name="file" accept="application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" />
            </div>
          </fieldset>
          <input type="submit" value="Reset pairing system"/>
        </form>
      </div>

      <div id="matrix">
          <div class="hint">Click on a cell in order to edit the score, or on a name in order to udpate it</div>
          <table>
            <tbody><!-- (See `refreshMatrix`) --> </tbody>
          </table>
      </div>

      <!--div id="assign">
        <div class="teams">
          <label>Teams:</label>
          <div class="name">
            <span class="left"></span>
            <span class="right"></span>
          </div>
        </div>
        <div class="defender">
          <label>Defender:</label>
          <div class="choice">
            <span class="left">TODO</span>
            <span class="right">TODO</span>
          </div>
        </div>
        <div class="attacker">
          <label>Attacker n°1:</label>
          <div class="choice">
            <span class="left">TODO</span>
            <span class="right">TODO</span>
          </div>
        </div>
        <div class="attacker">
          <label>Attacker n°2:</label>
          <div class="choice">
            <span class="left">TODO</span>
            <span class="right">TODO</span>
          </div>
        </div>
      </div>

      <div id="analysis">
        <div class="waiting hidden"></div>
        <fieldset class="teams">
          <legend>Select your team:</legend>
          <div>
            <input type="radio" id="row" name="team" value="row" checked />
            <label for="row"></label>
          </div>        
          <div>
            <input type="radio" id="column" name="team" value="column" />
            <label for="column"></label>
          </div>
        </fieldset>
        <fieldset class="selector">
          <legend>Select the army:</legend>
          <div></div>
        </fieldset>

      </div-->

      <div id="tables">
        <div class="teams">
          <label>Teams:</label>
          <div class="name">
            <span class="left"></span>
            <span class="right"></span>
          </div>
        </div>
        <!-- (see `refreshTables`)
        <div>
          <label>Table #</label>
          <div class="table">
            <span class="left">Army 1</span>
            <span class="right">Army 2</span>
          </div>
        </div>
        -->
      </div>

      <div id="export">
        <a class="download type-json" onclick="downloadJsonState();" download="data.json">Download JSON state</a>
        <a class="download type-xlsx" onclick="downloadXlsxState();" download="matrix.xlsx">Download Excel file</a>
      </div>

    </section>

    <section id="edit_score">
      <form>
        <fieldset>
          <legend>Context</legend>
          <div>
            <span class="left">Row</span>
            <span class="right name">
              <span id="row_team"></span>
              <span>—</span>
              <span id="row_army"></span>
            </span>
          </div>
          <div>
            <span class="left">Column</span>
            <span class="right name">
              <span id="col_team"></span>
              <span>—</span>
              <span id="col_army"></span>
            </span>
          </div>
          <div>
            <span class="left">Previous score</span>
            <span class="right score" id="score_prev"></span>
          </div>
          <div>
            <span class="left">New score</span>
            <span class="right score" id="score_next"></span>
          </div>
        </fieldset>
        <fieldset>
          <legend>New score values</legend>
          <div>
            <label for="new_score_min">Minimum</label>
            <input id="new_score_min" name="minimum" type="number" step="1" min="0" max="20" value="0" />
          </div>
          <div>
            <label for="new_score_max">Maximum</label>
            <input id="new_score_max" name="maximum" type="number" step="1" min="0" max="20" value="20" />
          </div>
        </fieldset>
        <input type="submit" value="Set new score"/>
      </form>
    </section>

    <section id="edit_team">
      <form>
        <div>
          <span class="left">Current team name</span>
          <span class="right name" id="current_team_name"></span>
        </div>
        <div>
          <label for="new_team_name">New army name</label>
          <input id="new_team_name" name="name" type="text" minlength="1" maxlength="25" pattern="^[0-9a-zA-Z \\-_]+$" required/>
        </div>
        <input type="submit" value="Update team name"/>
      </form>
    </section>

    <section id="edit_army">
      <form>
        <div>
          <span class="left">Team name</span>
          <span class="right name" id="team_name"></span>
        </div>
        <div>
          <span class="left">Current army name</span>
          <span class="right name" id="army_name"></span>
        </div>
        <div>
          <label for="new_army_name">New army name</label>
          <input id="new_army_name" name="name" type="text" minlength="1" maxlength="25" pattern="^[0-9a-zA-Z \\-_]+$" required/>
        </div>
        <input type="submit" value="Update army name"/>
      </form>
    </section>

		<footer>
			<span class="left">Made with ❤️ for the <a href="https://mgwa.forumactif.com/">MGWA organization</a></span>
			<span class="right">Source on <a href="https://github.com/flarcher/mgwa-pairing-table-tool">GitHub</a>. Licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons BY-NC-SA</a></span>
		</footer>
  </body>
</html>
